/**
 * Copyright 2013 Craig Campbell
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Rainbow is a simple code syntax highlighter
 *
 * @preserve @version 1.2
 * @url rainbowco.de
 */
window.Rainbow=function(){function n(n,e,t,r){var a=n.getAttribute&&n.getAttribute(e)||0
if(!a)for(t=n.attributes,r=0;r<t.length;++r)if(t[r].nodeName===e)return t[r].nodeValue
return a}function e(n,e){n.className+=n.className?" "+e:e}function t(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")>-1}function r(e){var t=n(e,"data-language")||n(e.parentNode,"data-language")
if(!t){var r=/\blang(?:uage)?-(\w+)/,a=e.className.match(r)||e.parentNode.className.match(r)
a&&(t=a[1])}return t}function a(n){return n.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;")}function o(n,e,t,r){return t>=n&&e>t?!0:r>n&&e>r}function u(n,e,t,r){return t==n&&r==e?!1:n>=t&&r>=e}function i(n,e){for(var t in L[R])if(t=parseInt(t,10),u(t,L[R][t],n,e)&&(delete L[R][t],delete T[R][t]),o(t,L[R][t],n,e))return!0
return!1}function c(n,e){return'<span class="'+n.replace(/\./g," ")+(N?" "+N:"")+'">'+e+"</span>"}function f(n,e){var t,r=0
for(t=1;e>t;++t)n[t]&&(r+=n[t].length)
return r}function s(n,e,t,r){if("undefined"==typeof n||null===n)return r()
var a=n.exec(t)
if(!a)return r();++M,e.name||"string"!=typeof e.matches[0]||(e.name=e.matches[0],delete e.matches[0])
var o=a[0],u=a.index,l=a[0].length+u,g=function(){var a=function(){s(n,e,t,r)}
return M%100>0?a():setTimeout(a,0)}
if(i(u,l))return g()
var v=function(n){e.name&&(n=c(e.name,n)),T[R]||(T[R]={},L[R]={}),T[R][u]={replace:a[0],"with":n},L[R][u]=l,g()},w=d(e.matches),b=function(n,t,r){if(n>=t.length)return r(o)
var u=function(){b(++n,t,r)},i=a[t[n]]
if(!i)return u()
var s=e.matches[t[n]],l=s.language,g=s.name&&s.matches?s.matches:s,d=function(e,r,i){o=m(f(a,t[n]),e,i?c(i,r):r,o),u()}
return l?p(i,l,function(n){d(i,n)}):"string"==typeof s?d(i,i,s):void h(i,g.length?g:[g],function(n){d(i,n,s.matches?s.name:0)})}
b(0,w,v)}function l(n){return H[n]}function g(n){var e=E[n]||[],t=E[C]||[]
return l(n)?e:e.concat(t)}function m(n,e,t,r){var a=r.substr(n)
return r.substr(0,n)+a.replace(e,t)}function d(n){var e=[]
for(var t in n)n.hasOwnProperty(t)&&e.push(t)
return e.sort(function(n,e){return e-n})}function h(n,e,t){function r(e,a){return a<e.length?s(e[a].pattern,e[a],n,function(){r(e,++a)}):void v(n,function(n){delete T[R],delete L[R],--R,t(n)})}++R,r(e,0)}function v(n,e){function t(n,e,r,a){if(r<e.length){++x
var o=e[r],u=T[R][o]
n=m(o,u.replace,u["with"],n)
var i=function(){t(n,e,++r,a)}
return x%250>0?i():setTimeout(i,0)}a(n)}var r=d(T[R])
t(n,r,0,e)}function p(n,e,t){var r=g(e)
h(a(n),r,t)}function w(n,a,o){if(a<n.length){var u=n[a],i=r(u)
return!t(u,"rainbow")&&i?(i=i.toLowerCase(),e(u,"rainbow"),p(u.innerHTML,i,function(e){u.innerHTML=e,T={},L={},y&&y(u,i),setTimeout(function(){w(n,++a,o)},0)})):w(n,++a,o)}o&&o()}function b(n,e){n=n&&"function"==typeof n.getElementsByTagName?n:document
var t,r=n.getElementsByTagName("pre"),a=n.getElementsByTagName("code"),o=[],u=[]
for(t=0;t<r.length;++t)r[t].getElementsByTagName("code").length?r[t].innerHTML=r[t].innerHTML.replace(/^\s+/,"").replace(/\s+$/,""):o.push(r[t])
for(t=0;t<a.length;++t)u.push(a[t])
w(u.concat(o),0,e)}var N,y,T={},L={},E={},H={},R=0,C=0,M=0,x=0
return{extend:function(n,e,t){1==arguments.length&&(e=n,n=C),H[n]=t,E[n]=e.concat(E[n]||[])},onHighlight:function(n){y=n},addClass:function(n){N=n},color:function(){return"string"==typeof arguments[0]?p(arguments[0],arguments[1],arguments[2]):"function"==typeof arguments[0]?b(0,arguments[0]):void b(arguments[0],arguments[1])}}}(),function(){return document.addEventListener?document.addEventListener("DOMContentLoaded",Rainbow.color,!1):void window.attachEvent("onload",Rainbow.color)}(),Rainbow.onHighlight=Rainbow.onHighlight,Rainbow.addClass=Rainbow.addClass
